<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Homework 3</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>無標題文件</title>
<style>
@import url(http://cs.nccu.edu.tw/~jonesyu/960gs/code/css/960.css);
@import url(http://cs.nccu.edu.tw/~jonesyu/960gs/code/css/reset.css);
@import url(http://cs.nccu.edu.tw/~jonesyu/960gs/code/css/text.css);

.location{
        display: inline-block;
        padding:4px 12px;
}

a{
        text-decoration: none;
        display: inline-block;
        padding:4px 0;
      }

a:hover{
        color: #4D2078; 
        text-decoration: underline;
        color:blue;
        cursor: pointer;
        -webkit-transition: all 0.4s ease;
}

#result{
        padding-top: 40px;
        padding-bottom: 30px;
        display:block;
        line-height: 20px;
        background-color:#eeeeee;
}
#result p{
        font-weight: bold;
        margin-left: 20px;
        margin-top: 20px;
        display:block;
        line-height: 20px;
        font-size: 18px;
}
#result div{
        margin-left: 20px;
        display:block;
        font-size: 16px;

}
#method{
        margin-bottom: 40px;
}
</style>
</head>

<body>
<header><h1 style="padding:40px;">Homework City's combo box</h1></header>
<div class="container_12">
    <div class="grid_12"></div>
    <div class="grid_3" id="method" >
          <h3>功能一:直接點擊</h3> 

              <div class="location"><a href="#" id="2306188">七堵</div>
              <div class="location"><a href="#" id="2306179">內湖</a></div>
              <div class="location"><a href="#" id="2306211">淡水</a></div>
              <div class="location"><a href="#" id="2306214">鶯歌</a></div>
              <div class="location"><a href="#" id="2306223">金山</a></div>
              <div class="location"><a href="#" id="2306228">三芝</a></div>
              <div class="location"><a href="#" id="2306231">萬里</a></div>
              <div class="location"><a href="#" id="2306251">雙溪</a></div>
              <div class="location"><a href="#" id="2306209">大園</a></div>
              <div class="location"><a href="#" id="2306184">中壢</a></div>
              <div class="location"><a href="#" id="2306200">觀音</a></div>
              <div class="location"><a href="#" id="2306202">龍潭</a></div>
              <div class="location"><a href="#" id="2306254">桃園國際機場</a></div>
              <div class="location"><a href="#" id="2306185">東區</a></div>
              <div class="location"><a href="#" id="2306229">三灣</a></div>
              <div class="location"><a href="#" id="2306181">西屯</a></div>
              <div class="location"><a href="#" id="2306207">石岡</a></div>
              <div class="location"><a href="#"id="2306194">清水</a></div>
              <div class="location"><a href="#" id="2306218">新社</a></div>
              <div class="location"><a href="#" id="2306210">大甲</a></div>
              <div class="location"><a href="#" id="2306183">彰化市</a></div>
              <div class="location"><a href="#" id="2306195">二林</a></div>
               <div class="location"><a href="#" id="2306201">鹿港</a></div>
               <div class="location"><a href="#" id="2306212">斗南</a></div>
               <div class="location"><a href="#" id="2306250">虎尾</a></div>
               <div class="location"><a href="#" id="2306206">布袋</a></div>
               <div class="location"><a href="#" id="2306182">安平</a></div>
               <div class="location"><a href="#" id="2306193">佳里</a></div>
               <div class="location"><a href="#" id="2306203">麻豆</a></div>
               <div class="location"><a href="#" id="2306217">新化</a></div>
             <div class="location"><a href="#" id="2306232">玉井</a></div>
             <div class="location"><a href="#" id="2306180">左營</a></div>
             <div class="location"><a href="#" id="2306199">岡山</a></div>
             <div class="location"><a href="#" id="2306255">高雄國際機場</a></div>
             <div class="location"><a href="#" id="2306189">屏東市</a></div>
             <div class="location"><a href="#" id="2306213">東港</a></div>
             <div class="location"><a href="#" id="2306224">枋山</a></div>
               <div class="location"><a href="#" id="2306198">宜蘭市</a></div>
               <div class="location"><a href="#" id="2306208">蘇澳</a></div>
               <div class="location"><a href="#" id="2306243">南澳</a></div>
               <div class="location"><a href="#" id="2306187">花蓮市</a></div>
               <div class="location"><a href="#" id="2306190">台東市</a></div>
               <div class="location"><a href="#" id="2306227">關山</a></div>
               <div class="location"><a href="#" id="2306204">南投市</a></div>
     
               <h3>功能二:下拉式選單</h3>
            <select id="citybox1">
                <option>基隆</option>
                <option>台北</option>
                <option>新北市</option>
                <option>桃園</option>
                <option>新竹</option>
                <option>苗栗</option>
                <option>台中</option>
                <option>彰化</option>
                <option>雲林</option>
                <option>嘉義</option>
                <option>台南</option>
                <option>高雄</option>
                <option>屏東</option>
                <option>宜蘭</option>
                <option>花蓮</option>
                <option>台東</option>
                <option>南投</option>
            </select>
            <select id="citybox2">
            </select>
    
    </div>
    <div class="grid_9" id="result">
          <p>Title</p>
          <div id="title"></div>
          <p>Date</p>
          <div id="Date"></div>
          <p>Location</p>
          <div id="Location"></div>
          <p>Temp</p>
          <div id="Temp"></div>
          <p>Text</p>
          <div id="Text"></div>
    </div>
</div>

<script>
        function getData (wid) {
            var woeid = wid;
            var query = 'select * from weather.forecast where woeid=' + woeid;
            var url = 'http://query.yahooapis.com/v1/public/yql?format=json&q=' + query;
            
            $.getJSON(
                url,
                {}, 
                function(data, status){
                    var item = data['query']['results']['channel']['item'];
                    var location = item['lat']+','+item['long'];
                    var title = item['title'];
                    var date = item['pubDate'];
                    var temp = item['condition']['temp'];
                    var text = item['condition']['text'];
                    $('#Location').text(location);
                    $('#title').text(title);
                    $('#Date').text(date);
                    $('#Temp').text(temp);
                    $('#Text').text(text);
            })
        }

        $('a').click(function(e){
          var target = e.target;  
          getData(target.id);
        });

        var table = {};
            table['基隆'] = ['<option>七堵</option>'];
            table['台北'] = ['<option>內湖</option>', '<option>新店</option>'];
            table['新北市'] = ['<option>淡水</option>', '<option>鶯歌</option>', '<option>金山</option>', '<option>三芝</option>','<option>萬里</option>', '<option>雙溪</option>'];
            table['桃園'] = ['<option">大園</option>', '<option>中壢</option>', '<option>觀音</option>', '<option>龍潭</option>', '<option>桃園國際機場</option>'];
            table['新竹'] = ['<option>東區</option>'];
            table['苗栗'] = ['<option>三灣</option>'];
            table['台中'] = ['<option>西屯</option>', '<option>石岡</option>'                      , '<option>清水</option>', '<option>新社</option>'
                          , '<option>大甲</option>'];
            table['彰化'] = ['<option>彰化市</option>', '<option>二林</option>'
                          , '<option>鹿港</option>'];
            table['雲林'] = ['<option>斗南</option>', '<option>虎尾</option>'];
            table['嘉義'] = ['<option>布袋</option>'];
            table['台南'] = ['<option>安平</option>', '<option>佳里</option>'
                          , '<option>麻豆</option>', '<option>新化</option>'
                          , '<option>玉井</option>'];
            table['高雄'] = ['<option>左營</option>', '<option>岡山</option>'
                          , '<option>高雄國際機場</option>'];
            table['屏東'] = ['<option>屏東市</option>', '<option>東港</option>', '<option>枋山</option>'];
            table['宜蘭'] = ['<option>宜蘭市</option>', '<option>蘇澳</option>', '<option>南澳</option>'];
            table['花蓮'] = ['<option>花蓮市</option>'];
            table['台東'] = ['<option>台東市</option>', '<option>關山</option>'];
            table['南投'] = ['<option>南投市</option>'];

        var location_id = {};
            location_id['七堵'] = ['2306188'];
            location_id['內湖'] = ['2306179'];
            location_id['新店']= ['2306186'];
            location_id['淡水']=['2306211'];
            location_id['鶯歌']=['2306214'];
            location_id['金山']=['2306223'];
            location_id['三芝']=['2306228'];
            location_id['萬里']=['2306231'];
            location_id['雙溪']=['2306251'];
            location_id['大園']=['2306209'];
            location_id['中壢']=['2306184'];
            location_id['觀音']=['2306200'];
            location_id['龍潭']=['2306202'];
            location_id['桃園國際機場']=['2306254'];
            location_id['東區']=['2306185'];
            location_id['三灣']=['2306229'];
            location_id['西屯']=['2306181'];
            location_id['石岡']=['2306207'];
            location_id['清水']=['2306194'];
            location_id['新社']=['2306218'];
            location_id['大甲']=['2306210'];
            location_id['彰化市']=['2306183'];
            location_id['二林']=['2306195'];
            location_id['鹿港']=['2306201'];
            location_id['斗南']=['2306212'];
            location_id['安平']=['2306182'];
            location_id['虎尾']=['2306250'];
            location_id['布袋']=['2306206'];
            location_id['佳里']=['2306193'];
            location_id['麻豆']=['2306203'];
            location_id['新化']=['2306217'];
            location_id['玉井']=['2306232'];
            location_id['左營']=['2306180'];
            location_id['岡山']=['2306199'];
            location_id['高雄國際機場']=['2306255'];
            location_id['屏東市']=['2306189'];
            location_id['東港']=['2306213'];
            location_id['枋山']=['2306224'];
            location_id['宜蘭市']=['2306198'];
            location_id['蘇澳']=['2306208'];
            location_id['南澳']=['2306243'];
            location_id['花蓮市']=['2306187'];
            location_id['台東市']=['2306190'];
            location_id['關山']=['2306227'];
            location_id['南投市']=['2306204'];

        $('#citybox1').on('change', function(e){
            var target = e.target;
            var city = $(e.target).val();
             
            var newOption = table[city].join();   
            $('#citybox2').html(newOption);
            
            var city_location = $('#citybox2 option').val();						 
            var city_location_id = location_id[city_location];  
            
            getData(city_location_id);
            
        });


        $('#citybox2').on('change', function(e){
            var target = $(e.target).val();
            var city_location_id = location_id[target];
            getData(city_location_id);
        });
</script>
</body>
</html>